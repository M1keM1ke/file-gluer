plugins {
    id 'java'
}

group = 'ru.mikemimike'

java {
    sourceCompatibility = JavaVersion.VERSION_21
    targetCompatibility = JavaVersion.VERSION_21
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.yaml:snakeyaml:2.5'
    implementation("commons-cli:commons-cli:1.10.0")
    implementation("org.eclipse.jgit:org.eclipse.jgit:7.3.0.202506031305-r")
    implementation 'ch.qos.logback:logback-classic:1.5.13'
}

jar {
    archiveBaseName.set('file-gluer')

    manifest {
        attributes(
                'Main-Class': 'ru.mikemimike.filegluer.FileGluerApplication'
        )
    }
    from {
        configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) }
    }
    duplicatesStrategy = DuplicatesStrategy.EXCLUDE

    exclude 'META-INF/*.SF'
    exclude 'META-INF/*.DSA'
    exclude 'META-INF/*.RSA'
}

tasks.build {
    dependsOn jar
}